####### Display GIT-SVN in prompt #######

PS1='[\u at \h on \W$(__git_svn_ps1 "(%s)")]\$ '

# Git/Subversion prompt function
__git_svn_ps1() {
    local s=
    if [[ -d ".svn" ]] ; then
        local r=`__svn_rev`
        local b=`__svn_branch`
        s=" ($b:$r)"
    elif [[ -d .git ]] ; then
        s=`__git_ps1`
    fi
    echo -n "$s"
}
 
# Outputs the current trunk, branch, or tag
__svn_branch() {
    local url=
    if [[ -d .svn ]]; then
        url=`svn info | grep ^URL | awk -F\/ '{print $NF}'`
        echo $url
    fi
}
 
# Outputs the current revision
__svn_rev() {
    local r=$(svn info | awk '/Revision:/ {print $2}')
 
    if [ ! -z $SVN_SHOWDIRTYSTATE ]; then
        local svnst flag
        svnst=$(svn status | grep '^\s*[?ACDMR?!]')
        [ -z "$svnst" ] && flag=*
        r=$r$flag
    fi
    echo $r
}